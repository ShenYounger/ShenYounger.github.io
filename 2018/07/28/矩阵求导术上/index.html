<!DOCTYPE html>



  


<html class="theme-next pisces use-motion" lang="">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT" />










<meta name="description" content="本文转自知乎专栏文章矩阵求导术(上)，作者为知乎用户长躯鬼侠。转载此篇文章的目的在于：在不修改原文内容的基础之上，添加个人的理解及思考心得。本篇文章转载已征得原文作者同意。原文内容如下，小括号内的红色字体为本人所做的说明和心得。 矩阵求导的技术，在统计学、控制论、机器学习等领域有广泛的应用。鉴于我看过的一些资料或言之不详、或繁乱无绪，本文来做个科普，分作两篇，上篇讲标量对矩阵的求导术，下篇讲矩阵对">
<meta property="og:type" content="article">
<meta property="og:title" content="矩阵求导术(上)">
<meta property="og:url" content="http://yoursite.com/2018/07/28/矩阵求导术上/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="本文转自知乎专栏文章矩阵求导术(上)，作者为知乎用户长躯鬼侠。转载此篇文章的目的在于：在不修改原文内容的基础之上，添加个人的理解及思考心得。本篇文章转载已征得原文作者同意。原文内容如下，小括号内的红色字体为本人所做的说明和心得。 矩阵求导的技术，在统计学、控制论、机器学习等领域有广泛的应用。鉴于我看过的一些资料或言之不详、或繁乱无绪，本文来做个科普，分作两篇，上篇讲标量对矩阵的求导术，下篇讲矩阵对">
<meta property="og:locale" content="default">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=%5Cboldsymbol%7Bx%7D+">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=%5Cfrac%7B%5Cpartial+f%7D%7B%5Cpartial+X%7D+%3D+%5Cleft%5B%5Cfrac%7B%5Cpartial+f+%7D%7B%5Cpartial+X_%7Bij%7D%7D%5Cright%5D">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=X_%7Bij%7D">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=df+%3D+f%27%28x%29dx">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=df+%3D+%5Csum_%7Bi%3D1%7D%5En+%5Cfrac%7B%5Cpartial+f%7D%7B%5Cpartial+x_i%7Ddx_i+%3D+%5Cfrac%7B%5Cpartial+f%7D%7B%5Cpartial+%5Cboldsymbol%7Bx%7D%7D%5ET+d%5Cboldsymbol%7Bx%7D+">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=df">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=n%5Ctimes1">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=%5Cfrac%7B%5Cpartial+f%7D%7B%5Cpartial+%5Cboldsymbol%7Bx%7D%7D">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=n%5Ctimes1">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=d%5Cboldsymbol%7Bx%7D">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=df+%3D+%5Csum_%7Bi%3D1%7D%5Em+%5Csum_%7Bj%3D1%7D%5En+%5Cfrac%7B%5Cpartial+f%7D%7B%5Cpartial+X_%7Bij%7D%7DdX_%7Bij%7D+%3D+%5Ctext%7Btr%7D%5Cleft%28%5Cfrac%7B%5Cpartial+f%7D%7B%5Cpartial+X%7D%5ET+dX%5Cright%29+">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=%5Ctext%7Btr%7D%28A%5ETB%29+%3D+%5Csum_%7Bi%2Cj%7DA_%7Bij%7DB_%7Bij%7D">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=%5Ctext%7Btr%7D%28A%5ETB%29">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=df">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=m%5Ctimes+n">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=%5Cfrac%7B%5Cpartial+f%7D%7B%5Cpartial+X%7D">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=m%5Ctimes+n">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=dX">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=f+%3D+%5Clog%282%2B%5Csin+x%29e%5E%7B%5Csqrt%7Bx%7D%7D">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=d%28X%5Cpm+Y%29+%3D+dX+%5Cpm+dY">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=d%28XY%29+%3D+dX+Y+%2B+X+dY+">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=d%28X%5ET%29+%3D+%28dX%29%5ET">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=d%5Ctext%7Btr%7D%28X%29+%3D+%5Ctext%7Btr%7D%28dX%29">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=dX%5E%7B-1%7D+%3D+-X%5E%7B-1%7DdX+X%5E%7B-1%7D">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=XX%5E%7B-1%7D%3DI">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=d%7CX%7C+%3D+%5Ctext%7Btr%7D%28X%5E%7B%5C%23%7DdX%29+">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=X%5E%7B%5C%23%7D">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=d%7CX%7C%3D+%7CX%7C%5Ctext%7Btr%7D%28X%5E%7B-1%7DdX%29">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=d%28X%5Codot+Y%29+%3D+dX%5Codot+Y+%2B+X%5Codot+dY">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=%5Codot">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=d%5Csigma%28X%29+%3D+%5Csigma%27%28X%29%5Codot+dX+">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=%5Csigma%28X%29+%3D+%5Cleft%5B%5Csigma%28X_%7Bij%7D%29%5Cright%5D">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=df+%3D+%5Ctext%7Btr%7D%5Cleft%28%5Cfrac%7B%5Cpartial+f%7D%7B%5Cpartial+X%7D%5ET+dX%5Cright%29+">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=df">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=a+%3D+%5Ctext%7Btr%7D%28a%29">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=%5Cmathrm%7Btr%7D%28A%5ET%29+%3D+%5Cmathrm%7Btr%7D%28A%29">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=%5Ctext%7Btr%7D%28A%5Cpm+B%29+%3D+%5Ctext%7Btr%7D%28A%29%5Cpm+%5Ctext%7Btr%7D%28B%29">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=%5Ctext%7Btr%7D%28AB%29+%3D+%5Ctext%7Btr%7D%28BA%29">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=A">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=B%5ET">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=%5Csum_%7Bi%2Cj%7DA_%7Bij%7DB_%7Bji%7D">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=%5Ctext%7Btr%7D%28A%5ET%28B%5Codot+C%29%29+%3D+%5Ctext%7Btr%7D%28%28A%5Codot+B%29%5ETC%29">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=A%2C+B%2C+C">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=%5Csum_%7Bi%2Cj%7DA_%7Bij%7DB_%7Bij%7DC_%7Bij%7D">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=%5Cfrac%7B%5Cpartial+f%7D%7B%5Cpartial+Y%7D">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=%5Cfrac%7B%5Cpartial+f%7D%7B%5Cpartial+X%7D">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=%5Cfrac%7B%5Cpartial+f%7D%7B%5Cpartial+x%7D+%3D+%5Cfrac%7B%5Cpartial+f%7D%7B%5Cpartial+y%7D+%5Cfrac%7B%5Cpartial+y%7D%7B%5Cpartial+x%7D">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=%5Cfrac%7B%5Cpartial+Y%7D%7B%5Cpartial+X%7D">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=df+%3D+%5Ctext%7Btr%7D%5Cleft%28%5Cfrac%7B%5Cpartial+f%7D%7B%5Cpartial+Y%7D%5ET+dY%5Cright%29">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=%5Cfrac%7B%5Cpartial+f%7D%7B%5Cpartial+X%7D">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=f+%3D+%5Cboldsymbol%7Ba%7D%5ET+X%5Cboldsymbol%7Bb%7D">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=%5Cfrac%7B%5Cpartial+f%7D%7B%5Cpartial+X%7D">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=%5Cboldsymbol%7Ba%7D">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=m%C3%971">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=X">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=m%5Ctimes+n">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=%5Cboldsymbol%7Bb%7D">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=n%C3%971">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=f">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=df+%3D+%5Cboldsymbol%7Ba%7D%5ET+dX%5Cboldsymbol%7Bb%7D+">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=df+%3D+%5Ctext%7Btr%7D%28%5Cboldsymbol%7Ba%7D%5ETdX%5Cboldsymbol%7Bb%7D%29+%3D+%5Ctext%7Btr%7D%28%5Cboldsymbol%7Bb%7D%5Cboldsymbol%7Ba%7D%5ETdX%29">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=%5Ctext%7Btr%7D%28AB%29+%3D+%5Ctext%7Btr%7D%28BA%29">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=%5Cboldsymbol%7Ba%7D%5ETdX">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=%5Cboldsymbol%7Bb%7D">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=df+%3D+%5Ctext%7Btr%7D%5Cleft%28%5Cfrac%7B%5Cpartial+f%7D%7B%5Cpartial+X%7D%5ET+dX%5Cright%29">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=%5Cfrac%7B%5Cpartial+f%7D%7B%5Cpartial+X%7D+%3D+%28%5Cboldsymbol%7Bb%7D%5Cboldsymbol%7Ba%7D%5ET%29%5ET%3D+%5Cboldsymbol%7Ba%7D%5Cboldsymbol%7Bb%7D%5ET">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=%5Cfrac%7B%5Cpartial+f%7D%7B%5Cpartial+X%7D+%3D%5Cboldsymbol%7Ba%7D%5ET+%5Cfrac%7B%5Cpartial+X%7D%7B%5Cpartial+X%7D%5Cboldsymbol%7Bb%7D%3D%3F">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=l+%3D+%5C%7CX%5Cboldsymbol%7Bw%7D-+%5Cboldsymbol%7By%7D%5C%7C%5E2">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=%5Cboldsymbol%7Bw%7D">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=%5Cfrac%7B%5Cpartial+l%7D%7B%5Cpartial+%5Cboldsymbol%7Bw%7D%7D">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=%5Cboldsymbol%7By%7D">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=m%C3%971">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=X">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=m%5Ctimes+n">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=%5Cboldsymbol%7Bw%7D">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=n%C3%971">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=l">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=l+%3D+%28X%5Cboldsymbol%7Bw%7D-+%5Cboldsymbol%7By%7D%29%5ET%28X%5Cboldsymbol%7Bw%7D-+%5Cboldsymbol%7By%7D%29">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=dl+%3D+%28Xd%5Cboldsymbol%7Bw%7D%29%5ET%28X%5Cboldsymbol%7Bw%7D-%5Cboldsymbol%7By%7D%29%2B%28X%5Cboldsymbol%7Bw%7D-%5Cboldsymbol%7By%7D%29%5ET%28Xd%5Cboldsymbol%7Bw%7D%29+%3D+2%28X%5Cboldsymbol%7Bw%7D-%5Cboldsymbol%7By%7D%29%5ETXd%5Cboldsymbol%7Bw%7D">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=dl+%3D+%5Cfrac%7B%5Cpartial+l%7D%7B%5Cpartial+%5Cboldsymbol%7Bw%7D%7D%5ETd%5Cboldsymbol%7Bw%7D">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=%5Cfrac%7B%5Cpartial+l%7D%7B%5Cpartial+%5Cboldsymbol%7Bw%7D%7D%3D+%282%28X%5Cboldsymbol%7Bw%7D-%5Cboldsymbol%7By%7D%29%5ETX%29%5ET+%3D+2X%5ET%28X%5Cboldsymbol%7Bw%7D-%5Cboldsymbol%7By%7D%29">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=%5Cfrac%7B%5Cpartial+l%7D%7B%5Cpartial+%5Cboldsymbol%7Bw%7D%7D">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=%5Cboldsymbol%7Bw%7D">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=%5Cboldsymbol%7Bw%7D+%3D+%28X%5ETX%29%5E%7B-1%7DX%5ET%5Cboldsymbol%7By%7D">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=l+%3D+-%5Cboldsymbol%7By%7D%5ET%5Clog%5Ctext%7Bsoftmax%7D%28W%5Cboldsymbol%7Bx%7D%29">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=%5Cfrac%7B%5Cpartial+l%7D%7B%5Cpartial+W%7D">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=%5Cboldsymbol%7By%7D">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=m%C3%971">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=W">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=m%5Ctimes+n">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=%5Cboldsymbol%7Bx%7D">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=n%C3%971">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=l">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=%5Ctext%7Bsoftmax%7D%28%5Cboldsymbol%7Ba%7D%29+%3D+%5Cfrac%7B%5Cexp%28%5Cboldsymbol%7Ba%7D%29%7D%7B%5Cboldsymbol%7B1%7D%5ET%5Cexp%28%5Cboldsymbol%7Ba%7D%29%7D">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=%5Cexp%28%5Cboldsymbol%7Ba%7D%29">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=%5Cboldsymbol%7B1%7D">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=l+%3D+-%5Cboldsymbol%7By%7D%5ET+%5Cleft%28%5Clog+%28%5Cexp%28W%5Cboldsymbol%7Bx%7D%29%29-%5Cboldsymbol%7B1%7D%5Clog%28%5Cboldsymbol%7B1%7D%5ET%5Cexp%28W%5Cboldsymbol%7Bx%7D%29%29%5Cright%29+%3D+-%5Cboldsymbol%7By%7D%5ETW%5Cboldsymbol%7Bx%7D+%2B+%5Clog%28%5Cboldsymbol%7B1%7D%5ET%5Cexp%28W%5Cboldsymbol%7Bx%7D%29%29">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=%5Clog%28%5Cboldsymbol%7Bu%7D%2Fc%29+%3D+%5Clog%28%5Cboldsymbol%7Bu%7D%29+-+%5Cboldsymbol%7B1%7D%5Clog%28c%29">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=%5Cboldsymbol%7By%7D">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=%5Cboldsymbol%7By%7D%5ET+%5Cboldsymbol%7B1%7D+%3D+1">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=dl+%3D-+%5Cboldsymbol%7By%7D%5ETdW%5Cboldsymbol%7Bx%7D%2B%5Cfrac%7B%5Cboldsymbol%7B1%7D%5ET%5Cleft%28%5Cexp%28W%5Cboldsymbol%7Bx%7D%29%5Codot%28dW%5Cboldsymbol%7Bx%7D%29%5Cright%29%7D%7B%5Cboldsymbol%7B1%7D%5ET%5Cexp%28W%5Cboldsymbol%7Bx%7D%29%7D">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=%5Cboldsymbol%7B1%7D%5ET%5Cleft%28%5Cexp%28W%5Cboldsymbol%7Bx%7D%29%5Codot%28dW%5Cboldsymbol%7Bx%7D%29%5Cright%29+%3D+%5Cexp%28W%5Cboldsymbol%7Bx%7D%29%5ETdW%5Cboldsymbol%7Bx%7D">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=%5Cboldsymbol%7B1%7D%5ET+%28%5Cboldsymbol%7Bu%7D%5Codot+%5Cboldsymbol%7Bv%7D%29+%3D+%5Cboldsymbol%7Bu%7D%5ET+%5Cboldsymbol%7Bv%7D">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=dl+%3D+%5Ctext%7Btr%7D%5Cleft%28-%5Cboldsymbol%7By%7D%5ETdW%5Cboldsymbol%7Bx%7D%2B%5Cfrac%7B%5Cexp%28W%5Cboldsymbol%7Bx%7D%29%5ETdW%5Cboldsymbol%7Bx%7D%7D%7B%5Cboldsymbol%7B1%7D%5ET%5Cexp%28W%5Cboldsymbol%7Bx%7D%29%7D%5Cright%29+%3D%5Ctext%7Btr%7D%28%5Cboldsymbol%7Bx%7D%28%5Ctext%7Bsoftmax%7D%28W%5Cboldsymbol%7Bx%7D%29-%5Cboldsymbol%7By%7D%29%5ETdW%29">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=%5Cfrac%7B%5Cpartial+l%7D%7B%5Cpartial+W%7D%3D+%28%5Ctext%7Bsoftmax%7D%28W%5Cboldsymbol%7Bx%7D%29-%5Cboldsymbol%7By%7D%29%5Cboldsymbol%7Bx%7D%5ET">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=%5Cboldsymbol%7Ba%7D+%3D+W%5Cboldsymbol%7Bx%7D">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=l+%3D+-%5Cboldsymbol%7By%7D%5ET%5Clog%5Ctext%7Bsoftmax%7D%28%5Cboldsymbol%7Ba%7D%29+">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=%5Cfrac%7B%5Cpartial+l%7D%7B%5Cpartial+%5Cboldsymbol%7Ba%7D%7D+%3D+%5Ctext%7Bsoftmax%7D%28%5Cboldsymbol%7Ba%7D%29-%5Cboldsymbol%7By%7D+">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=dl+%3D+%5Ctext%7Btr%7D%5Cleft%28%5Cfrac%7B%5Cpartial+l%7D%7B%5Cpartial+%5Cboldsymbol%7Ba%7D%7D%5ETd%5Cboldsymbol%7Ba%7D%5Cright%29+%3D+%5Ctext%7Btr%7D%5Cleft%28%5Cfrac%7B%5Cpartial+l%7D%7B%5Cpartial+%5Cboldsymbol%7Ba%7D%7D%5ETdW+%5Cboldsymbol%7Bx%7D%5Cright%29+%3D+%5Ctext%7Btr%7D%5Cleft%28%5Cboldsymbol%7Bx%7D%5Cfrac%7B%5Cpartial+l%7D%7B%5Cpartial+%5Cboldsymbol%7Ba%7D%7D%5ETdW%5Cright%29">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=%5Cfrac%7B%5Cpartial+l%7D%7B%5Cpartial+W%7D%3D+%5Cfrac%7B%5Cpartial+l%7D%7B%5Cpartial%5Cboldsymbol%7Ba%7D%7D%5Cboldsymbol%7Bx%7D%5ET">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=%5Cboldsymbol%7Bx%7D_1%2C%5Cdots%2C+%5Cboldsymbol%7Bx%7D_n%5Csim+N%28%5Cboldsymbol%7B%5Cmu%7D%2C+%5CSigma%29">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=%5CSigma">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=l+%3D+%5Clog%7C%5CSigma%7C%2B%5Cfrac%7B1%7D%7Bn%7D%5Csum_%7Bi%3D1%7D%5En%28%5Cboldsymbol%7Bx%7D_i-%5Cboldsymbol%7B%5Cbar%7Bx%7D%7D%29%5ET%5CSigma%5E%7B-1%7D%28%5Cboldsymbol%7Bx%7D_i-%5Cboldsymbol%7B%5Cbar%7Bx%7D%7D%29">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=%5Cfrac%7B%5Cpartial+l+%7D%7B%5Cpartial+%5CSigma%7D">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=%5Cboldsymbol%7Bx%7D_i">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=m%5Ctimes+1">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=%5Coverline%7B%5Cboldsymbol%7Bx%7D%7D%3D%5Cfrac%7B1%7D%7Bn%7D%5Csum_%7Bi%3D1%7D%5En+%5Cboldsymbol%7Bx%7D_i">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=%5CSigma">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=m%5Ctimes+m">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=l">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=d%5Clog%7C%5CSigma%7C+%3D+%7C%5CSigma%7C%5E%7B-1%7Dd%7C%5CSigma%7C+%3D+%5Ctext%7Btr%7D%28%5CSigma%5E%7B-1%7Dd%5CSigma%29">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=%5Cfrac%7B1%7D%7Bn%7D%5Csum_%7Bi%3D1%7D%5En%28%5Cboldsymbol%7Bx%7D_i-%5Cboldsymbol%7B%5Cbar%7Bx%7D%7D%29%5ETd%5CSigma%5E%7B-1%7D%28%5Cboldsymbol%7Bx%7D_i-%5Cboldsymbol%7B%5Cbar%7Bx%7D%7D%29+%3D+-%5Cfrac%7B1%7D%7Bn%7D%5Csum_%7Bi%3D1%7D%5En%28%5Cboldsymbol%7Bx%7D_i-%5Cboldsymbol%7B%5Cbar%7Bx%7D%7D%29%5ET%5CSigma%5E%7B-1%7Dd%5CSigma%5CSigma%5E%7B-1%7D%28%5Cboldsymbol%7Bx%7D_i-%5Cboldsymbol%7B%5Cbar%7Bx%7D%7D%29">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=+%5Ctext%7Btr%7D%5Cleft%28%5Cfrac%7B1%7D%7Bn%7D%5Csum_%7Bi%3D1%7D%5En%28%5Cboldsymbol%7Bx%7D_i-%5Cboldsymbol%7B%5Cbar%7Bx%7D%7D%29%5ET%5CSigma%5E%7B-1%7Dd%5CSigma%5CSigma%5E%7B-1%7D%28%5Cboldsymbol%7Bx%7D_i-%5Cboldsymbol%7B%5Cbar%7Bx%7D%7D%29%5Cright%29+%3D+%5Cfrac%7B1%7D%7Bn%7D%5Csum_%7Bi%3D1%7D%5En%5Ctext%7Btr%7D%5Cleft%28%28%5Cboldsymbol%7Bx%7D_i-%5Cboldsymbol%7B%5Cbar%7Bx%7D%7D%29%5ET%5CSigma%5E%7B-1%7Dd%5CSigma%5CSigma%5E%7B-1%7D%28%5Cboldsymbol%7Bx%7D_i-%5Cboldsymbol%7B%5Cbar%7Bx%7D%7D%29%5Cright%29+">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=%3D+%5Cfrac%7B1%7D%7Bn%7D%5Csum_%7Bi%3D1%7D%5En%5Ctext%7Btr%7D%5Cleft%28%5CSigma%5E%7B-1%7D%28%5Cboldsymbol%7Bx%7D_i-%5Cboldsymbol%7B%5Cbar%7Bx%7D%7D%29%28%5Cboldsymbol%7Bx%7D_i-%5Cboldsymbol%7B%5Cbar%7Bx%7D%7D%29%5ET%5CSigma%5E%7B-1%7Dd%5CSigma%5Cright%29%3D%5Ctext%7Btr%7D%28%5CSigma%5E%7B-1%7DS%5CSigma%5E%7B-1%7Dd%5CSigma%29">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=%5CSigma%5E%7B-1%7D%28%5Cboldsymbol%7Bx%7D_i-%5Cboldsymbol%7B%5Cbar%7Bx%7D%7D%29">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=S+%3D+%5Cfrac%7B1%7D%7Bn%7D%5Csum_%7Bi%3D1%7D%5En%28%5Cboldsymbol%7Bx%7D_i-%5Cboldsymbol%7B%5Cbar%7Bx%7D%7D%29%28%5Cboldsymbol%7Bx%7D_i-%5Cboldsymbol%7B%5Cbar%7Bx%7D%7D%29%5ET">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=dl+%3D+%5Ctext%7Btr%7D%5Cleft%28%5Cleft%28%5CSigma%5E%7B-1%7D-%5CSigma%5E%7B-1%7DS%5CSigma%5E%7B-1%7D%5Cright%29d%5CSigma%5Cright%29">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=%5Cfrac%7B%5Cpartial+l+%7D%7B%5Cpartial+%5CSigma%7D%3D%28%5CSigma%5E%7B-1%7D-%5CSigma%5E%7B-1%7DS%5CSigma%5E%7B-1%7D%29%5ET">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=%5CSigma">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=%5CSigma+%3D+S">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=l+%3D+-%5Cboldsymbol%7By%7D%5ET%5Clog%5Ctext%7Bsoftmax%7D%28W_2%5Csigma%28W_1%5Cboldsymbol%7Bx%7D%29%29">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=%5Cfrac%7B%5Cpartial+l%7D%7B%5Cpartial+W_1%7D">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=%5Cfrac%7B%5Cpartial+l%7D%7B%5Cpartial+W_2%7D">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=%5Cboldsymbol%7By%7D">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=m%C3%971">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=W_2">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=m%5Ctimes+p">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=W_1">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=p%5Ctimes+n">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=%5Cboldsymbol%7Bx%7D">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=n%C3%971">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=l">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=%5Ctext%7Bsoftmax%7D%28%5Cboldsymbol%7Ba%7D%29+%3D+%5Cfrac%7B%5Cexp%28%5Cboldsymbol%7Ba%7D%29%7D%7B%5Cboldsymbol%7B1%7D%5ET%5Cexp%28%5Cboldsymbol%7Ba%7D%29%7D">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=%5Csigma%28%5Ccdot%29">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=%5Csigma%28a%29+%3D+%5Cfrac%7B1%7D%7B1%2B%5Cexp%28-a%29%7D">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=%5Cboldsymbol%7Ba%7D_1%3DW_1%5Cboldsymbol%7Bx%7D">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=%5Cboldsymbol%7Bh%7D_1+%3D+%5Csigma%28%5Cboldsymbol%7Ba%7D_1%29">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=%5Cboldsymbol%7Ba%7D_2+%3D+W_2+%5Cboldsymbol%7Bh%7D_1">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=l+%3D-%5Cboldsymbol%7By%7D%5ET%5Clog%5Ctext%7Bsoftmax%7D%28%5Cboldsymbol%7Ba%7D_2%29">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=%5Cfrac%7B%5Cpartial+l%7D%7B%5Cpartial+%5Cboldsymbol%7Ba%7D_2%7D+%3D+%5Ctext%7Bsoftmax%7D%28%5Cboldsymbol%7Ba%7D_2%29-%5Cboldsymbol%7By%7D+">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=%5Cboldsymbol%7Bh%7D_1%2C+W_2">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=dl+%3D+%5Ctext%7Btr%7D%5Cleft%28%5Cfrac%7B%5Cpartial+l%7D%7B%5Cpartial+%5Cboldsymbol%7Ba%7D_2%7D%5ETd%5Cboldsymbol%7Ba%7D_2%5Cright%29+%3D+%5Ctext%7Btr%7D%5Cleft%28%5Cfrac%7B%5Cpartial+l%7D%7B%5Cpartial+%5Cboldsymbol%7Ba%7D_2%7D%5ETdW_2+%5Cboldsymbol%7Bh%7D_1%5Cright%29+%2B+%5Ctext%7Btr%7D%5Cleft%28%5Cfrac%7B%5Cpartial+l%7D%7B%5Cpartial+%5Cboldsymbol%7Ba%7D_2%7D%5ETW_2+d%5Cboldsymbol%7Bh%7D_1%5Cright%29">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=%5Cfrac%7B%5Cpartial+l%7D%7B%5Cpartial+W_2%7D%3D+%5Cfrac%7B%5Cpartial+l%7D%7B%5Cpartial%5Cboldsymbol%7Ba%7D_2%7D%5Cboldsymbol%7Bh%7D_1%5ET">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=%5Cfrac%7B%5Cpartial+l%7D%7B%5Cpartial+%5Cboldsymbol%7Bh%7D_1%7D%3D+W_2%5ET%5Cfrac%7B%5Cpartial+l%7D%7B%5Cpartial%5Cboldsymbol%7Ba%7D_2%7D">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=%5Cfrac%7B%5Cpartial+l%7D%7B%5Cpartial+%5Cboldsymbol%7Ba%7D_1%7D">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=%5Ctext%7Btr%7D%5Cleft%28%5Cfrac%7B%5Cpartial+l%7D%7B%5Cpartial%5Cboldsymbol%7Bh%7D_1%7D%5ETd%5Cboldsymbol%7Bh%7D_1%5Cright%29+%3D+%5Ctext%7Btr%7D%5Cleft%28%5Cfrac%7B%5Cpartial+l%7D%7B%5Cpartial%5Cboldsymbol%7Bh%7D_1%7D%5ET%28%5Csigma%27%28%5Cboldsymbol%7Ba%7D_1%29%5Codot+d%5Cboldsymbol%7Ba%7D_1%29%5Cright%29+%3D+%5Ctext%7Btr%7D%5Cleft%28%5Cleft%28%5Cfrac%7B%5Cpartial+l%7D%7B%5Cpartial%5Cboldsymbol%7Bh%7D_1%7D%5Codot+%5Csigma%27%28%5Cboldsymbol%7Ba%7D_1%29%5Cright%29%5ETd%5Cboldsymbol%7Ba%7D_1%5Cright%29">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=%5Cfrac%7B%5Cpartial+l%7D%7B%5Cpartial+%5Cboldsymbol%7Ba%7D_1%7D%3D+%5Cfrac%7B%5Cpartial+l%7D%7B%5Cpartial%5Cboldsymbol%7Bh%7D_1%7D%5Codot%5Csigma%27%28%5Cboldsymbol%7Ba%7D_1%29">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=%5Cfrac%7B%5Cpartial+l%7D%7B%5Cpartial+W_1%7D">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=%5Ctext%7Btr%7D%5Cleft%28%5Cfrac%7B%5Cpartial+l%7D%7B%5Cpartial%5Cboldsymbol%7Ba%7D_1%7D%5ETd%5Cboldsymbol%7Ba%7D_1%5Cright%29+%3D+%5Ctext%7Btr%7D%5Cleft%28%5Cfrac%7B%5Cpartial+l%7D%7B%5Cpartial%5Cboldsymbol%7Ba%7D_1%7D%5ETdW_1%5Cboldsymbol%7Bx%7D%5Cright%29+%3D+%5Ctext%7Btr%7D%5Cleft%28%5Cboldsymbol%7Bx%7D%5Cfrac%7B%5Cpartial+l%7D%7B%5Cpartial%5Cboldsymbol%7Ba%7D_1%7D%5ETdW_1%5Cright%29">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=%5Cfrac%7B%5Cpartial+l%7D%7B%5Cpartial+W_1%7D%3D+%5Cfrac%7B%5Cpartial+l%7D%7B%5Cpartial%5Cboldsymbol%7Ba%7D_1%7D%5Cboldsymbol%7Bx%7D%5ET">
<meta property="og:updated_time" content="2018-07-28T16:26:25.679Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="矩阵求导术(上)">
<meta name="twitter:description" content="本文转自知乎专栏文章矩阵求导术(上)，作者为知乎用户长躯鬼侠。转载此篇文章的目的在于：在不修改原文内容的基础之上，添加个人的理解及思考心得。本篇文章转载已征得原文作者同意。原文内容如下，小括号内的红色字体为本人所做的说明和心得。 矩阵求导的技术，在统计学、控制论、机器学习等领域有广泛的应用。鉴于我看过的一些资料或言之不详、或繁乱无绪，本文来做个科普，分作两篇，上篇讲标量对矩阵的求导术，下篇讲矩阵对">
<meta name="twitter:image" content="https://www.zhihu.com/equation?tex=%5Cboldsymbol%7Bx%7D+">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/2018/07/28/矩阵求导术上/"/>





  <title>矩阵求导术(上) | Hexo</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="default">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Hexo</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            Archives
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/07/28/矩阵求导术上/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">矩阵求导术(上)</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-07-28T23:46:42+08:00">
                2018-07-28
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>本文转自知乎专栏文章<strong>矩阵求导术(上)</strong>，作者为知乎用户<strong>长躯鬼侠</strong>。转载此篇文章的目的在于：在不修改原文内容的基础之上，添加个人的理解及思考心得。本篇文章转载已征得原文作者同意。原文内容如下，<strong>小括号内的红色字体</strong>为本人所做的说明和心得。</p>
<p>矩阵求导的技术，在统计学、控制论、机器学习等领域有广泛的应用。鉴于我看过的一些资料或言之不详、或繁乱无绪，本文来做个科普，分作两篇，上篇讲标量对矩阵的求导术，下篇讲矩阵对矩阵的求导术。本文使用小写字母x表示标量，粗体小写字母<img src="https://www.zhihu.com/equation?tex=%5Cboldsymbol%7Bx%7D+" alt="\boldsymbol{x} ">表示（列）向量，大写字母X表示矩阵。 </p>
<p>首先来琢磨一下定义，标量f对矩阵X的导数，定义为<img src="https://www.zhihu.com/equation?tex=%5Cfrac%7B%5Cpartial+f%7D%7B%5Cpartial+X%7D+%3D+%5Cleft%5B%5Cfrac%7B%5Cpartial+f+%7D%7B%5Cpartial+X_%7Bij%7D%7D%5Cright%5D" alt="\frac{\partial f}{\partial X} = \left[\frac{\partial f }{\partial X_{ij}}\right]">，即f对X逐元素求导排成与X尺寸相同的矩阵。然而，这个定义在计算中并不好用，实用上的原因是在对较复杂的函数难以逐元素求导；哲理上的原因是逐元素求导破坏了<strong>整体性</strong>。试想，为何要将f看做矩阵X而不是各元素<img src="https://www.zhihu.com/equation?tex=X_%7Bij%7D" alt="X_{ij}">的函数呢？答案是用矩阵运算更整洁。所以在求导时不宜拆开矩阵，而是要找一个从整体出发的算法。</p>
<p>为此，我们来回顾，一元微积分中的导数（标量对标量的导数）与微分有联系：<img src="https://www.zhihu.com/equation?tex=df+%3D+f%27%28x%29dx" alt="df = f&#39;(x)dx">；多元微积分中的梯度（标量对向量的导数）也与微分有联系：<img src="https://www.zhihu.com/equation?tex=df+%3D+%5Csum_%7Bi%3D1%7D%5En+%5Cfrac%7B%5Cpartial+f%7D%7B%5Cpartial+x_i%7Ddx_i+%3D+%5Cfrac%7B%5Cpartial+f%7D%7B%5Cpartial+%5Cboldsymbol%7Bx%7D%7D%5ET+d%5Cboldsymbol%7Bx%7D+" alt="df = \sum_{i=1}^n \frac{\partial f}{\partial x_i}dx_i = \frac{\partial f}{\partial \boldsymbol{x}}^T d\boldsymbol{x} ">，这里第一个等号是全微分公式，第二个等号表达了梯度与微分的联系：全微分<img src="https://www.zhihu.com/equation?tex=df" alt="df">是<img src="https://www.zhihu.com/equation?tex=n%5Ctimes1" alt="n\times1">梯度向量<img src="https://www.zhihu.com/equation?tex=%5Cfrac%7B%5Cpartial+f%7D%7B%5Cpartial+%5Cboldsymbol%7Bx%7D%7D" alt="\frac{\partial f}{\partial \boldsymbol{x}}">与<img src="https://www.zhihu.com/equation?tex=n%5Ctimes1" alt="n\times1">微分向量<img src="https://www.zhihu.com/equation?tex=d%5Cboldsymbol%7Bx%7D" alt="d\boldsymbol{x}">的内积；受此启发，我们将矩阵导数与微分建立联系：<img src="https://www.zhihu.com/equation?tex=df+%3D+%5Csum_%7Bi%3D1%7D%5Em+%5Csum_%7Bj%3D1%7D%5En+%5Cfrac%7B%5Cpartial+f%7D%7B%5Cpartial+X_%7Bij%7D%7DdX_%7Bij%7D+%3D+%5Ctext%7Btr%7D%5Cleft%28%5Cfrac%7B%5Cpartial+f%7D%7B%5Cpartial+X%7D%5ET+dX%5Cright%29+" alt="df = \sum_{i=1}^m \sum_{j=1}^n \frac{\partial f}{\partial X_{ij}}dX_{ij} = \text{tr}\left(\frac{\partial f}{\partial X}^T dX\right) ">。其中tr代表迹(trace)是方阵对角线元素之和，满足性质：对尺寸相同的矩阵A,B，<img src="https://www.zhihu.com/equation?tex=%5Ctext%7Btr%7D%28A%5ETB%29+%3D+%5Csum_%7Bi%2Cj%7DA_%7Bij%7DB_%7Bij%7D" alt="\text{tr}(A^TB) = \sum_{i,j}A_{ij}B_{ij}">，即<img src="https://www.zhihu.com/equation?tex=%5Ctext%7Btr%7D%28A%5ETB%29" alt="\text{tr}(A^TB)">是矩阵A,B的<strong>内积</strong>。与梯度相似，这里第一个等号是全微分公式，第二个等号表达了矩阵导数与微分的联系：全微分<img src="https://www.zhihu.com/equation?tex=df" alt="df">是<img src="https://www.zhihu.com/equation?tex=m%5Ctimes+n" alt="m\times n">导数<img src="https://www.zhihu.com/equation?tex=%5Cfrac%7B%5Cpartial+f%7D%7B%5Cpartial+X%7D" alt="\frac{\partial f}{\partial X}">与<img src="https://www.zhihu.com/equation?tex=m%5Ctimes+n" alt="m\times n">微分矩阵<img src="https://www.zhihu.com/equation?tex=dX" alt="dX">的内积。( $\textcolor{Red}{注意} $  $df$在这里是一个标量，之所以要引入$\text{tr}$，是因为$\left(\frac{\partial f}{\partial X}^T \right)$和$dX$都是矩阵，他们俩的乘积仍然是一个矩阵，$\text{tr}$的引入可以将$\frac{\partial f}{\partial X}^T dX$转化为一个标量)</p>
<p>回想遇到较复杂的一元函数如<img src="https://www.zhihu.com/equation?tex=f+%3D+%5Clog%282%2B%5Csin+x%29e%5E%7B%5Csqrt%7Bx%7D%7D" alt="f = \log(2+\sin x)e^{\sqrt{x}}">，我们是如何求导的呢？通常不是从定义开始求极限，而是先建立了初等函数求导和四则运算、复合等法则，再来运用这些法则。故而，我们来创立常用的矩阵微分的运算法则：($\textcolor{Red}{注意} $上述所说的四则运算为和差积商)</p>
<ol>
<li>加减法：<img src="https://www.zhihu.com/equation?tex=d%28X%5Cpm+Y%29+%3D+dX+%5Cpm+dY" alt="d(X\pm Y) = dX \pm dY">；矩阵乘法：<img src="https://www.zhihu.com/equation?tex=d%28XY%29+%3D+dX+Y+%2B+X+dY+" alt="d(XY) = dX Y + X dY ">；转置：<img src="https://www.zhihu.com/equation?tex=d%28X%5ET%29+%3D+%28dX%29%5ET" alt="d(X^T) = (dX)^T">；迹：<img src="https://www.zhihu.com/equation?tex=d%5Ctext%7Btr%7D%28X%29+%3D+%5Ctext%7Btr%7D%28dX%29" alt="d\text{tr}(X) = \text{tr}(dX)">。</li>
<li>逆：<img src="https://www.zhihu.com/equation?tex=dX%5E%7B-1%7D+%3D+-X%5E%7B-1%7DdX+X%5E%7B-1%7D" alt="dX^{-1} = -X^{-1}dX X^{-1}">。此式可在<img src="https://www.zhihu.com/equation?tex=XX%5E%7B-1%7D%3DI" alt="XX^{-1}=I">两侧求微分来证明。($\textcolor{Red}{注意} $通过上面的矩阵乘法法则可以得出)</li>
<li>行列式：<img src="https://www.zhihu.com/equation?tex=d%7CX%7C+%3D+%5Ctext%7Btr%7D%28X%5E%7B%5C%23%7DdX%29+" alt="d|X| = \text{tr}(X^{\# }dX) ">，其中<img src="https://www.zhihu.com/equation?tex=X%5E%7B%5C%23%7D" alt="X^{\# }">表示X的伴随矩阵，在X可逆时又可以写作<img src="https://www.zhihu.com/equation?tex=d%7CX%7C%3D+%7CX%7C%5Ctext%7Btr%7D%28X%5E%7B-1%7DdX%29" alt="d|X|= |X|\text{tr}(X^{-1}dX)">。此式可用Laplace展开来证明，详见张贤达《矩阵分析与应用》第279页。</li>
<li>逐元素乘法：<img src="https://www.zhihu.com/equation?tex=d%28X%5Codot+Y%29+%3D+dX%5Codot+Y+%2B+X%5Codot+dY" alt="d(X\odot Y) = dX\odot Y + X\odot dY">，<img src="https://www.zhihu.com/equation?tex=%5Codot" alt="\odot">表示尺寸相同的矩阵X,Y逐元素相乘。</li>
<li>逐元素函数：<img src="https://www.zhihu.com/equation?tex=d%5Csigma%28X%29+%3D+%5Csigma%27%28X%29%5Codot+dX+" alt="d\sigma(X) = \sigma&#39;(X)\odot dX ">，<img src="https://www.zhihu.com/equation?tex=%5Csigma%28X%29+%3D+%5Cleft%5B%5Csigma%28X_%7Bij%7D%29%5Cright%5D" alt="\sigma(X) = \left[\sigma(X_{ij})\right]">是逐元素运算的标量函数。</li>
</ol>
<p>我们试图利用矩阵导数与微分的联系<img src="https://www.zhihu.com/equation?tex=df+%3D+%5Ctext%7Btr%7D%5Cleft%28%5Cfrac%7B%5Cpartial+f%7D%7B%5Cpartial+X%7D%5ET+dX%5Cright%29+" alt="df = \text{tr}\left(\frac{\partial f}{\partial X}^T dX\right) ">，在求出左侧的微分<img src="https://www.zhihu.com/equation?tex=df" alt="df">后，该如何写成右侧的形式并得到导数呢？这需要一些迹技巧(trace trick)：</p>
<ol>
<li>标量套上迹：<img src="https://www.zhihu.com/equation?tex=a+%3D+%5Ctext%7Btr%7D%28a%29" alt="a = \text{tr}(a)"></li>
<li>转置：<img src="https://www.zhihu.com/equation?tex=%5Cmathrm%7Btr%7D%28A%5ET%29+%3D+%5Cmathrm%7Btr%7D%28A%29" alt="\mathrm{tr}(A^T) = \mathrm{tr}(A)">。</li>
<li>线性：<img src="https://www.zhihu.com/equation?tex=%5Ctext%7Btr%7D%28A%5Cpm+B%29+%3D+%5Ctext%7Btr%7D%28A%29%5Cpm+%5Ctext%7Btr%7D%28B%29" alt="\text{tr}(A\pm B) = \text{tr}(A)\pm \text{tr}(B)">。</li>
<li>矩阵乘法交换：<img src="https://www.zhihu.com/equation?tex=%5Ctext%7Btr%7D%28AB%29+%3D+%5Ctext%7Btr%7D%28BA%29" alt="\text{tr}(AB) = \text{tr}(BA)">，其中<img src="https://www.zhihu.com/equation?tex=A" alt="A">与<img src="https://www.zhihu.com/equation?tex=B%5ET" alt="B^T">尺寸相同。两侧都等于<img src="https://www.zhihu.com/equation?tex=%5Csum_%7Bi%2Cj%7DA_%7Bij%7DB_%7Bji%7D" alt="\sum_{i,j}A_{ij}B_{ji}">。</li>
<li>矩阵乘法/逐元素乘法交换：<img src="https://www.zhihu.com/equation?tex=%5Ctext%7Btr%7D%28A%5ET%28B%5Codot+C%29%29+%3D+%5Ctext%7Btr%7D%28%28A%5Codot+B%29%5ETC%29" alt="\text{tr}(A^T(B\odot C)) = \text{tr}((A\odot B)^TC)">，其中<img src="https://www.zhihu.com/equation?tex=A%2C+B%2C+C" alt="A, B, C">尺寸相同。两侧都等于<img src="https://www.zhihu.com/equation?tex=%5Csum_%7Bi%2Cj%7DA_%7Bij%7DB_%7Bij%7DC_%7Bij%7D" alt="\sum_{i,j}A_{ij}B_{ij}C_{ij}">。</li>
</ol>
<p>观察一下可以断言，<strong>若标量函数f是矩阵X经加减乘法、行列式、逆、逐元素函数等运算构成，则使用相应的运算法则对f求微分，再使用迹技巧给df套上迹并将其它项交换至dX左侧，即能得到导数。</strong></p>
<p>在建立法则的最后，来谈一谈复合：假设已求得<img src="https://www.zhihu.com/equation?tex=%5Cfrac%7B%5Cpartial+f%7D%7B%5Cpartial+Y%7D" alt="\frac{\partial f}{\partial Y}">，而Y是X的函数，如何求<img src="https://www.zhihu.com/equation?tex=%5Cfrac%7B%5Cpartial+f%7D%7B%5Cpartial+X%7D" alt="\frac{\partial f}{\partial X}">呢？在微积分中有标量求导的链式法则<img src="https://www.zhihu.com/equation?tex=%5Cfrac%7B%5Cpartial+f%7D%7B%5Cpartial+x%7D+%3D+%5Cfrac%7B%5Cpartial+f%7D%7B%5Cpartial+y%7D+%5Cfrac%7B%5Cpartial+y%7D%7B%5Cpartial+x%7D" alt="\frac{\partial f}{\partial x} = \frac{\partial f}{\partial y} \frac{\partial y}{\partial x}">，但这里我们不能沿用链式法则，因为矩阵对矩阵的导数<img src="https://www.zhihu.com/equation?tex=%5Cfrac%7B%5Cpartial+Y%7D%7B%5Cpartial+X%7D" alt="\frac{\partial Y}{\partial X}">截至目前仍是未定义的。于是我们继续追本溯源，链式法则是从何而来？源头仍然是微分。我们直接从微分入手建立复合法则：先写出<img src="https://www.zhihu.com/equation?tex=df+%3D+%5Ctext%7Btr%7D%5Cleft%28%5Cfrac%7B%5Cpartial+f%7D%7B%5Cpartial+Y%7D%5ET+dY%5Cright%29" alt="df = \text{tr}\left(\frac{\partial f}{\partial Y}^T dY\right)">，再将dY用dX表示出来代入，并使用迹技巧将其他项交换至dX左侧，即可得到<img src="https://www.zhihu.com/equation?tex=%5Cfrac%7B%5Cpartial+f%7D%7B%5Cpartial+X%7D" alt="\frac{\partial f}{\partial X}">。</p>
<p>接下来演示一些算例。特别提醒要依据已经建立的运算法则来计算，不能随意套用微积分中标量导数的结论，比如认为AX对X的导数为A，这是没有根据、意义不明的。</p>
<p>例1：<img src="https://www.zhihu.com/equation?tex=f+%3D+%5Cboldsymbol%7Ba%7D%5ET+X%5Cboldsymbol%7Bb%7D" alt="f = \boldsymbol{a}^T X\boldsymbol{b}">，求<img src="https://www.zhihu.com/equation?tex=%5Cfrac%7B%5Cpartial+f%7D%7B%5Cpartial+X%7D" alt="\frac{\partial f}{\partial X}">。其中<img src="https://www.zhihu.com/equation?tex=%5Cboldsymbol%7Ba%7D" alt="\boldsymbol{a}">是<img src="https://www.zhihu.com/equation?tex=m%C3%971" alt="m×1">列向量，<img src="https://www.zhihu.com/equation?tex=X" alt="X">是<img src="https://www.zhihu.com/equation?tex=m%5Ctimes+n" alt="m\times n">矩阵，<img src="https://www.zhihu.com/equation?tex=%5Cboldsymbol%7Bb%7D" alt="\boldsymbol{b}">是<img src="https://www.zhihu.com/equation?tex=n%C3%971" alt="n×1">列向量，<img src="https://www.zhihu.com/equation?tex=f" alt="f">是标量。</p>
<p>解：先使用矩阵乘法法则求微分：<img src="https://www.zhihu.com/equation?tex=df+%3D+%5Cboldsymbol%7Ba%7D%5ET+dX%5Cboldsymbol%7Bb%7D+" alt="df = \boldsymbol{a}^T dX\boldsymbol{b} ">（$\textcolor{Red}{注意} $在这里$\boldsymbol{a}$和$\boldsymbol{b}$都是常数矩阵，所以可以把$df$直接这么写)，再套上迹($\textcolor{Red}{注意} $在这里$df$是标量)并做矩阵乘法交换：<img src="https://www.zhihu.com/equation?tex=df+%3D+%5Ctext%7Btr%7D%28%5Cboldsymbol%7Ba%7D%5ETdX%5Cboldsymbol%7Bb%7D%29+%3D+%5Ctext%7Btr%7D%28%5Cboldsymbol%7Bb%7D%5Cboldsymbol%7Ba%7D%5ETdX%29" alt="df = \text{tr}(\boldsymbol{a}^TdX\boldsymbol{b}) = \text{tr}(\boldsymbol{b}\boldsymbol{a}^TdX)">，注意这里我们根据<img src="https://www.zhihu.com/equation?tex=%5Ctext%7Btr%7D%28AB%29+%3D+%5Ctext%7Btr%7D%28BA%29" alt="\text{tr}(AB) = \text{tr}(BA)">交换了<img src="https://www.zhihu.com/equation?tex=%5Cboldsymbol%7Ba%7D%5ETdX" alt="\boldsymbol{a}^TdX">与<img src="https://www.zhihu.com/equation?tex=%5Cboldsymbol%7Bb%7D" alt="\boldsymbol{b}">。对照导数与微分的联系<img src="https://www.zhihu.com/equation?tex=df+%3D+%5Ctext%7Btr%7D%5Cleft%28%5Cfrac%7B%5Cpartial+f%7D%7B%5Cpartial+X%7D%5ET+dX%5Cright%29" alt="df = \text{tr}\left(\frac{\partial f}{\partial X}^T dX\right)">，得到<img src="https://www.zhihu.com/equation?tex=%5Cfrac%7B%5Cpartial+f%7D%7B%5Cpartial+X%7D+%3D+%28%5Cboldsymbol%7Bb%7D%5Cboldsymbol%7Ba%7D%5ET%29%5ET%3D+%5Cboldsymbol%7Ba%7D%5Cboldsymbol%7Bb%7D%5ET" alt="\frac{\partial f}{\partial X} = (\boldsymbol{b}\boldsymbol{a}^T)^T= \boldsymbol{a}\boldsymbol{b}^T">。</p>
<p>注意：这里不能用<img src="https://www.zhihu.com/equation?tex=%5Cfrac%7B%5Cpartial+f%7D%7B%5Cpartial+X%7D+%3D%5Cboldsymbol%7Ba%7D%5ET+%5Cfrac%7B%5Cpartial+X%7D%7B%5Cpartial+X%7D%5Cboldsymbol%7Bb%7D%3D%3F" alt="\frac{\partial f}{\partial X} =\boldsymbol{a}^T \frac{\partial X}{\partial X}\boldsymbol{b}=?">，导数与乘常数矩阵的交换是不合法则的运算（而微分是合法的）。有些资料在计算矩阵导数时，会略过求微分这一步，这是逻辑上解释不通的。</p>
<p>例2【线性回归】：<img src="https://www.zhihu.com/equation?tex=l+%3D+%5C%7CX%5Cboldsymbol%7Bw%7D-+%5Cboldsymbol%7By%7D%5C%7C%5E2" alt="l = \|X\boldsymbol{w}- \boldsymbol{y}\|^2">， 求<img src="https://www.zhihu.com/equation?tex=%5Cboldsymbol%7Bw%7D" alt="\boldsymbol{w}">的最小二乘估计，即求<img src="https://www.zhihu.com/equation?tex=%5Cfrac%7B%5Cpartial+l%7D%7B%5Cpartial+%5Cboldsymbol%7Bw%7D%7D" alt="\frac{\partial l}{\partial \boldsymbol{w}}">的零点。其中<img src="https://www.zhihu.com/equation?tex=%5Cboldsymbol%7By%7D" alt="\boldsymbol{y}">是<img src="https://www.zhihu.com/equation?tex=m%C3%971" alt="m×1">列向量，<img src="https://www.zhihu.com/equation?tex=X" alt="X">是<img src="https://www.zhihu.com/equation?tex=m%5Ctimes+n" alt="m\times n">矩阵，<img src="https://www.zhihu.com/equation?tex=%5Cboldsymbol%7Bw%7D" alt="\boldsymbol{w}">是<img src="https://www.zhihu.com/equation?tex=n%C3%971" alt="n×1">列向量，<img src="https://www.zhihu.com/equation?tex=l" alt="l">是标量。<br>$$<br>(X\boldsymbol{w}-\boldsymbol{y})^T(Xd\boldsymbol{w})<br>$$<br>解：严格来说这是标量对向量的导数，不过可以把向量看做矩阵的特例。先将向量模平方改写成向量与自身的内积：<img src="https://www.zhihu.com/equation?tex=l+%3D+%28X%5Cboldsymbol%7Bw%7D-+%5Cboldsymbol%7By%7D%29%5ET%28X%5Cboldsymbol%7Bw%7D-+%5Cboldsymbol%7By%7D%29" alt="l = (X\boldsymbol{w}- \boldsymbol{y})^T(X\boldsymbol{w}- \boldsymbol{y})">($\textcolor{Red}{注意} $这种写法，用$A^TA$来表示A模的平方)，求微分，使用矩阵乘法、转置等法则：<img src="https://www.zhihu.com/equation?tex=dl+%3D+%28Xd%5Cboldsymbol%7Bw%7D%29%5ET%28X%5Cboldsymbol%7Bw%7D-%5Cboldsymbol%7By%7D%29%2B%28X%5Cboldsymbol%7Bw%7D-%5Cboldsymbol%7By%7D%29%5ET%28Xd%5Cboldsymbol%7Bw%7D%29+%3D+2%28X%5Cboldsymbol%7Bw%7D-%5Cboldsymbol%7By%7D%29%5ETXd%5Cboldsymbol%7Bw%7D" alt="dl = (Xd\boldsymbol{w})^T(X\boldsymbol{w}-\boldsymbol{y})+(X\boldsymbol{w}-\boldsymbol{y})^T(Xd\boldsymbol{w}) = 2(X\boldsymbol{w}-\boldsymbol{y})^TXd\boldsymbol{w}">($\textcolor{Red}{注意} $$(Xd\boldsymbol{w})^T(X\boldsymbol{w}-\boldsymbol{y})$和$(X\boldsymbol{w}-\boldsymbol{y})^T(Xd\boldsymbol{w})$在这里都是标量)。对照导数与微分的联系<img src="https://www.zhihu.com/equation?tex=dl+%3D+%5Cfrac%7B%5Cpartial+l%7D%7B%5Cpartial+%5Cboldsymbol%7Bw%7D%7D%5ETd%5Cboldsymbol%7Bw%7D" alt="dl = \frac{\partial l}{\partial \boldsymbol{w}}^Td\boldsymbol{w}">($\textcolor{Red}{注意} $在这里$\boldsymbol{w}$是向量，所以在这里没用$\text tr$)，得到<img src="https://www.zhihu.com/equation?tex=%5Cfrac%7B%5Cpartial+l%7D%7B%5Cpartial+%5Cboldsymbol%7Bw%7D%7D%3D+%282%28X%5Cboldsymbol%7Bw%7D-%5Cboldsymbol%7By%7D%29%5ETX%29%5ET+%3D+2X%5ET%28X%5Cboldsymbol%7Bw%7D-%5Cboldsymbol%7By%7D%29" alt="\frac{\partial l}{\partial \boldsymbol{w}}= (2(X\boldsymbol{w}-\boldsymbol{y})^TX)^T = 2X^T(X\boldsymbol{w}-\boldsymbol{y})">。<img src="https://www.zhihu.com/equation?tex=%5Cfrac%7B%5Cpartial+l%7D%7B%5Cpartial+%5Cboldsymbol%7Bw%7D%7D" alt="\frac{\partial l}{\partial \boldsymbol{w}}">的零点即<img src="https://www.zhihu.com/equation?tex=%5Cboldsymbol%7Bw%7D" alt="\boldsymbol{w}">的最小二乘估计为<img src="https://www.zhihu.com/equation?tex=%5Cboldsymbol%7Bw%7D+%3D+%28X%5ETX%29%5E%7B-1%7DX%5ET%5Cboldsymbol%7By%7D" alt="\boldsymbol{w} = (X^TX)^{-1}X^T\boldsymbol{y}">。</p>
<p>例3【多元logistic回归】：<img src="https://www.zhihu.com/equation?tex=l+%3D+-%5Cboldsymbol%7By%7D%5ET%5Clog%5Ctext%7Bsoftmax%7D%28W%5Cboldsymbol%7Bx%7D%29" alt="l = -\boldsymbol{y}^T\log\text{softmax}(W\boldsymbol{x})">，求<img src="https://www.zhihu.com/equation?tex=%5Cfrac%7B%5Cpartial+l%7D%7B%5Cpartial+W%7D" alt="\frac{\partial l}{\partial W}">。其中<img src="https://www.zhihu.com/equation?tex=%5Cboldsymbol%7By%7D" alt="\boldsymbol{y}">是除一个元素为1外其它元素为0的<img src="https://www.zhihu.com/equation?tex=m%C3%971" alt="m×1">列向量，<img src="https://www.zhihu.com/equation?tex=W" alt="W">是<img src="https://www.zhihu.com/equation?tex=m%5Ctimes+n" alt="m\times n">矩阵，<img src="https://www.zhihu.com/equation?tex=%5Cboldsymbol%7Bx%7D" alt="\boldsymbol{x}">是<img src="https://www.zhihu.com/equation?tex=n%C3%971" alt="n×1">列向量，<img src="https://www.zhihu.com/equation?tex=l" alt="l">是标量；<img src="https://www.zhihu.com/equation?tex=%5Ctext%7Bsoftmax%7D%28%5Cboldsymbol%7Ba%7D%29+%3D+%5Cfrac%7B%5Cexp%28%5Cboldsymbol%7Ba%7D%29%7D%7B%5Cboldsymbol%7B1%7D%5ET%5Cexp%28%5Cboldsymbol%7Ba%7D%29%7D" alt="\text{softmax}(\boldsymbol{a}) = \frac{\exp(\boldsymbol{a})}{\boldsymbol{1}^T\exp(\boldsymbol{a})}">($\textcolor{Red}{注意} $在这里$\text{softmax}$如何写成向量的形式)，其中<img src="https://www.zhihu.com/equation?tex=%5Cexp%28%5Cboldsymbol%7Ba%7D%29" alt="\exp(\boldsymbol{a})">表示逐元素求指数，<img src="https://www.zhihu.com/equation?tex=%5Cboldsymbol%7B1%7D" alt="\boldsymbol{1}">代表全1向量。</p>
<p>解：首先将softmax函数代入并写成<img src="https://www.zhihu.com/equation?tex=l+%3D+-%5Cboldsymbol%7By%7D%5ET+%5Cleft%28%5Clog+%28%5Cexp%28W%5Cboldsymbol%7Bx%7D%29%29-%5Cboldsymbol%7B1%7D%5Clog%28%5Cboldsymbol%7B1%7D%5ET%5Cexp%28W%5Cboldsymbol%7Bx%7D%29%29%5Cright%29+%3D+-%5Cboldsymbol%7By%7D%5ETW%5Cboldsymbol%7Bx%7D+%2B+%5Clog%28%5Cboldsymbol%7B1%7D%5ET%5Cexp%28W%5Cboldsymbol%7Bx%7D%29%29" alt="l = -\boldsymbol{y}^T \left(\log (\exp(W\boldsymbol{x}))-\boldsymbol{1}\log(\boldsymbol{1}^T\exp(W\boldsymbol{x}))\right) = -\boldsymbol{y}^TW\boldsymbol{x} + \log(\boldsymbol{1}^T\exp(W\boldsymbol{x}))">，这里要注意逐元素log满足等式<img src="https://www.zhihu.com/equation?tex=%5Clog%28%5Cboldsymbol%7Bu%7D%2Fc%29+%3D+%5Clog%28%5Cboldsymbol%7Bu%7D%29+-+%5Cboldsymbol%7B1%7D%5Clog%28c%29" alt="\log(\boldsymbol{u}/c) = \log(\boldsymbol{u}) - \boldsymbol{1}\log(c)">，以及<img src="https://www.zhihu.com/equation?tex=%5Cboldsymbol%7By%7D" alt="\boldsymbol{y}">满足<img src="https://www.zhihu.com/equation?tex=%5Cboldsymbol%7By%7D%5ET+%5Cboldsymbol%7B1%7D+%3D+1" alt="\boldsymbol{y}^T \boldsymbol{1} = 1">。求微分，使用矩阵乘法、逐元素函数等法则：<img src="https://www.zhihu.com/equation?tex=dl+%3D-+%5Cboldsymbol%7By%7D%5ETdW%5Cboldsymbol%7Bx%7D%2B%5Cfrac%7B%5Cboldsymbol%7B1%7D%5ET%5Cleft%28%5Cexp%28W%5Cboldsymbol%7Bx%7D%29%5Codot%28dW%5Cboldsymbol%7Bx%7D%29%5Cright%29%7D%7B%5Cboldsymbol%7B1%7D%5ET%5Cexp%28W%5Cboldsymbol%7Bx%7D%29%7D" alt="dl =- \boldsymbol{y}^TdW\boldsymbol{x}+\frac{\boldsymbol{1}^T\left(\exp(W\boldsymbol{x})\odot(dW\boldsymbol{x})\right)}{\boldsymbol{1}^T\exp(W\boldsymbol{x})}">。再套上迹并做交换，注意可化简<img src="https://www.zhihu.com/equation?tex=%5Cboldsymbol%7B1%7D%5ET%5Cleft%28%5Cexp%28W%5Cboldsymbol%7Bx%7D%29%5Codot%28dW%5Cboldsymbol%7Bx%7D%29%5Cright%29+%3D+%5Cexp%28W%5Cboldsymbol%7Bx%7D%29%5ETdW%5Cboldsymbol%7Bx%7D" alt="\boldsymbol{1}^T\left(\exp(W\boldsymbol{x})\odot(dW\boldsymbol{x})\right) = \exp(W\boldsymbol{x})^TdW\boldsymbol{x}">，这是根据等式<img src="https://www.zhihu.com/equation?tex=%5Cboldsymbol%7B1%7D%5ET+%28%5Cboldsymbol%7Bu%7D%5Codot+%5Cboldsymbol%7Bv%7D%29+%3D+%5Cboldsymbol%7Bu%7D%5ET+%5Cboldsymbol%7Bv%7D" alt="\boldsymbol{1}^T (\boldsymbol{u}\odot \boldsymbol{v}) = \boldsymbol{u}^T \boldsymbol{v}">，故<img src="https://www.zhihu.com/equation?tex=dl+%3D+%5Ctext%7Btr%7D%5Cleft%28-%5Cboldsymbol%7By%7D%5ETdW%5Cboldsymbol%7Bx%7D%2B%5Cfrac%7B%5Cexp%28W%5Cboldsymbol%7Bx%7D%29%5ETdW%5Cboldsymbol%7Bx%7D%7D%7B%5Cboldsymbol%7B1%7D%5ET%5Cexp%28W%5Cboldsymbol%7Bx%7D%29%7D%5Cright%29+%3D%5Ctext%7Btr%7D%28%5Cboldsymbol%7Bx%7D%28%5Ctext%7Bsoftmax%7D%28W%5Cboldsymbol%7Bx%7D%29-%5Cboldsymbol%7By%7D%29%5ETdW%29" alt="dl = \text{tr}\left(-\boldsymbol{y}^TdW\boldsymbol{x}+\frac{\exp(W\boldsymbol{x})^TdW\boldsymbol{x}}{\boldsymbol{1}^T\exp(W\boldsymbol{x})}\right) =\text{tr}(\boldsymbol{x}(\text{softmax}(W\boldsymbol{x})-\boldsymbol{y})^TdW)">。对照导数与微分的联系，得到<img src="https://www.zhihu.com/equation?tex=%5Cfrac%7B%5Cpartial+l%7D%7B%5Cpartial+W%7D%3D+%28%5Ctext%7Bsoftmax%7D%28W%5Cboldsymbol%7Bx%7D%29-%5Cboldsymbol%7By%7D%29%5Cboldsymbol%7Bx%7D%5ET" alt="\frac{\partial l}{\partial W}= (\text{softmax}(W\boldsymbol{x})-\boldsymbol{y})\boldsymbol{x}^T">。</p>
<p>另解：定义<img src="https://www.zhihu.com/equation?tex=%5Cboldsymbol%7Ba%7D+%3D+W%5Cboldsymbol%7Bx%7D" alt="\boldsymbol{a} = W\boldsymbol{x}">，则<img src="https://www.zhihu.com/equation?tex=l+%3D+-%5Cboldsymbol%7By%7D%5ET%5Clog%5Ctext%7Bsoftmax%7D%28%5Cboldsymbol%7Ba%7D%29+" alt="l = -\boldsymbol{y}^T\log\text{softmax}(\boldsymbol{a}) ">，先如上求出<img src="https://www.zhihu.com/equation?tex=%5Cfrac%7B%5Cpartial+l%7D%7B%5Cpartial+%5Cboldsymbol%7Ba%7D%7D+%3D+%5Ctext%7Bsoftmax%7D%28%5Cboldsymbol%7Ba%7D%29-%5Cboldsymbol%7By%7D+" alt="\frac{\partial l}{\partial \boldsymbol{a}} = \text{softmax}(\boldsymbol{a})-\boldsymbol{y} ">，再利用复合法则：<img src="https://www.zhihu.com/equation?tex=dl+%3D+%5Ctext%7Btr%7D%5Cleft%28%5Cfrac%7B%5Cpartial+l%7D%7B%5Cpartial+%5Cboldsymbol%7Ba%7D%7D%5ETd%5Cboldsymbol%7Ba%7D%5Cright%29+%3D+%5Ctext%7Btr%7D%5Cleft%28%5Cfrac%7B%5Cpartial+l%7D%7B%5Cpartial+%5Cboldsymbol%7Ba%7D%7D%5ETdW+%5Cboldsymbol%7Bx%7D%5Cright%29+%3D+%5Ctext%7Btr%7D%5Cleft%28%5Cboldsymbol%7Bx%7D%5Cfrac%7B%5Cpartial+l%7D%7B%5Cpartial+%5Cboldsymbol%7Ba%7D%7D%5ETdW%5Cright%29" alt="dl = \text{tr}\left(\frac{\partial l}{\partial \boldsymbol{a}}^Td\boldsymbol{a}\right) = \text{tr}\left(\frac{\partial l}{\partial \boldsymbol{a}}^TdW \boldsymbol{x}\right) = \text{tr}\left(\boldsymbol{x}\frac{\partial l}{\partial \boldsymbol{a}}^TdW\right)">，得到<img src="https://www.zhihu.com/equation?tex=%5Cfrac%7B%5Cpartial+l%7D%7B%5Cpartial+W%7D%3D+%5Cfrac%7B%5Cpartial+l%7D%7B%5Cpartial%5Cboldsymbol%7Ba%7D%7D%5Cboldsymbol%7Bx%7D%5ET" alt="\frac{\partial l}{\partial W}= \frac{\partial l}{\partial\boldsymbol{a}}\boldsymbol{x}^T">。</p>
<p>例4【方差的最大似然估计】：样本<img src="https://www.zhihu.com/equation?tex=%5Cboldsymbol%7Bx%7D_1%2C%5Cdots%2C+%5Cboldsymbol%7Bx%7D_n%5Csim+N%28%5Cboldsymbol%7B%5Cmu%7D%2C+%5CSigma%29" alt="\boldsymbol{x}_1,\dots, \boldsymbol{x}_n\sim N(\boldsymbol{\mu}, \Sigma)">，求方差<img src="https://www.zhihu.com/equation?tex=%5CSigma" alt="\Sigma">的最大似然估计。写成数学式是：<img src="https://www.zhihu.com/equation?tex=l+%3D+%5Clog%7C%5CSigma%7C%2B%5Cfrac%7B1%7D%7Bn%7D%5Csum_%7Bi%3D1%7D%5En%28%5Cboldsymbol%7Bx%7D_i-%5Cboldsymbol%7B%5Cbar%7Bx%7D%7D%29%5ET%5CSigma%5E%7B-1%7D%28%5Cboldsymbol%7Bx%7D_i-%5Cboldsymbol%7B%5Cbar%7Bx%7D%7D%29" alt="l = \log|\Sigma|+\frac{1}{n}\sum_{i=1}^n(\boldsymbol{x}_i-\boldsymbol{\bar{x}})^T\Sigma^{-1}(\boldsymbol{x}_i-\boldsymbol{\bar{x}})">，求<img src="https://www.zhihu.com/equation?tex=%5Cfrac%7B%5Cpartial+l+%7D%7B%5Cpartial+%5CSigma%7D" alt="\frac{\partial l }{\partial \Sigma}">的零点。其中<img src="https://www.zhihu.com/equation?tex=%5Cboldsymbol%7Bx%7D_i" alt="\boldsymbol{x}_i">是<img src="https://www.zhihu.com/equation?tex=m%5Ctimes+1" alt="m\times 1">列向量，<img src="https://www.zhihu.com/equation?tex=%5Coverline%7B%5Cboldsymbol%7Bx%7D%7D%3D%5Cfrac%7B1%7D%7Bn%7D%5Csum_%7Bi%3D1%7D%5En+%5Cboldsymbol%7Bx%7D_i" alt="\overline{\boldsymbol{x}}=\frac{1}{n}\sum_{i=1}^n \boldsymbol{x}_i">是样本均值，<img src="https://www.zhihu.com/equation?tex=%5CSigma" alt="\Sigma">是<img src="https://www.zhihu.com/equation?tex=m%5Ctimes+m" alt="m\times m">对称正定矩阵，<img src="https://www.zhihu.com/equation?tex=l" alt="l">是标量。</p>
<p>解：首先求微分，使用矩阵乘法、行列式、逆等运算法则，第一项是<img src="https://www.zhihu.com/equation?tex=d%5Clog%7C%5CSigma%7C+%3D+%7C%5CSigma%7C%5E%7B-1%7Dd%7C%5CSigma%7C+%3D+%5Ctext%7Btr%7D%28%5CSigma%5E%7B-1%7Dd%5CSigma%29" alt="d\log|\Sigma| = |\Sigma|^{-1}d|\Sigma| = \text{tr}(\Sigma^{-1}d\Sigma)">，第二项是<img src="https://www.zhihu.com/equation?tex=%5Cfrac%7B1%7D%7Bn%7D%5Csum_%7Bi%3D1%7D%5En%28%5Cboldsymbol%7Bx%7D_i-%5Cboldsymbol%7B%5Cbar%7Bx%7D%7D%29%5ETd%5CSigma%5E%7B-1%7D%28%5Cboldsymbol%7Bx%7D_i-%5Cboldsymbol%7B%5Cbar%7Bx%7D%7D%29+%3D+-%5Cfrac%7B1%7D%7Bn%7D%5Csum_%7Bi%3D1%7D%5En%28%5Cboldsymbol%7Bx%7D_i-%5Cboldsymbol%7B%5Cbar%7Bx%7D%7D%29%5ET%5CSigma%5E%7B-1%7Dd%5CSigma%5CSigma%5E%7B-1%7D%28%5Cboldsymbol%7Bx%7D_i-%5Cboldsymbol%7B%5Cbar%7Bx%7D%7D%29" alt="\frac{1}{n}\sum_{i=1}^n(\boldsymbol{x}_i-\boldsymbol{\bar{x}})^Td\Sigma^{-1}(\boldsymbol{x}_i-\boldsymbol{\bar{x}}) = -\frac{1}{n}\sum_{i=1}^n(\boldsymbol{x}_i-\boldsymbol{\bar{x}})^T\Sigma^{-1}d\Sigma\Sigma^{-1}(\boldsymbol{x}_i-\boldsymbol{\bar{x}})">。再给第二项套上迹做交换：<img src="https://www.zhihu.com/equation?tex=+%5Ctext%7Btr%7D%5Cleft%28%5Cfrac%7B1%7D%7Bn%7D%5Csum_%7Bi%3D1%7D%5En%28%5Cboldsymbol%7Bx%7D_i-%5Cboldsymbol%7B%5Cbar%7Bx%7D%7D%29%5ET%5CSigma%5E%7B-1%7Dd%5CSigma%5CSigma%5E%7B-1%7D%28%5Cboldsymbol%7Bx%7D_i-%5Cboldsymbol%7B%5Cbar%7Bx%7D%7D%29%5Cright%29+%3D+%5Cfrac%7B1%7D%7Bn%7D%5Csum_%7Bi%3D1%7D%5En%5Ctext%7Btr%7D%5Cleft%28%28%5Cboldsymbol%7Bx%7D_i-%5Cboldsymbol%7B%5Cbar%7Bx%7D%7D%29%5ET%5CSigma%5E%7B-1%7Dd%5CSigma%5CSigma%5E%7B-1%7D%28%5Cboldsymbol%7Bx%7D_i-%5Cboldsymbol%7B%5Cbar%7Bx%7D%7D%29%5Cright%29+" alt=" \text{tr}\left(\frac{1}{n}\sum_{i=1}^n(\boldsymbol{x}_i-\boldsymbol{\bar{x}})^T\Sigma^{-1}d\Sigma\Sigma^{-1}(\boldsymbol{x}_i-\boldsymbol{\bar{x}})\right) = \frac{1}{n}\sum_{i=1}^n\text{tr}\left((\boldsymbol{x}_i-\boldsymbol{\bar{x}})^T\Sigma^{-1}d\Sigma\Sigma^{-1}(\boldsymbol{x}_i-\boldsymbol{\bar{x}})\right) "><img src="https://www.zhihu.com/equation?tex=%3D+%5Cfrac%7B1%7D%7Bn%7D%5Csum_%7Bi%3D1%7D%5En%5Ctext%7Btr%7D%5Cleft%28%5CSigma%5E%7B-1%7D%28%5Cboldsymbol%7Bx%7D_i-%5Cboldsymbol%7B%5Cbar%7Bx%7D%7D%29%28%5Cboldsymbol%7Bx%7D_i-%5Cboldsymbol%7B%5Cbar%7Bx%7D%7D%29%5ET%5CSigma%5E%7B-1%7Dd%5CSigma%5Cright%29%3D%5Ctext%7Btr%7D%28%5CSigma%5E%7B-1%7DS%5CSigma%5E%7B-1%7Dd%5CSigma%29" alt="= \frac{1}{n}\sum_{i=1}^n\text{tr}\left(\Sigma^{-1}(\boldsymbol{x}_i-\boldsymbol{\bar{x}})(\boldsymbol{x}_i-\boldsymbol{\bar{x}})^T\Sigma^{-1}d\Sigma\right)=\text{tr}(\Sigma^{-1}S\Sigma^{-1}d\Sigma)">，其中先交换迹与求和，然后将 <img src="https://www.zhihu.com/equation?tex=%5CSigma%5E%7B-1%7D%28%5Cboldsymbol%7Bx%7D_i-%5Cboldsymbol%7B%5Cbar%7Bx%7D%7D%29" alt="\Sigma^{-1}(\boldsymbol{x}_i-\boldsymbol{\bar{x}})">交换到左边，最后再交换迹与求和，并定义<img src="https://www.zhihu.com/equation?tex=S+%3D+%5Cfrac%7B1%7D%7Bn%7D%5Csum_%7Bi%3D1%7D%5En%28%5Cboldsymbol%7Bx%7D_i-%5Cboldsymbol%7B%5Cbar%7Bx%7D%7D%29%28%5Cboldsymbol%7Bx%7D_i-%5Cboldsymbol%7B%5Cbar%7Bx%7D%7D%29%5ET" alt="S = \frac{1}{n}\sum_{i=1}^n(\boldsymbol{x}_i-\boldsymbol{\bar{x}})(\boldsymbol{x}_i-\boldsymbol{\bar{x}})^T">为样本方差矩阵。得到<img src="https://www.zhihu.com/equation?tex=dl+%3D+%5Ctext%7Btr%7D%5Cleft%28%5Cleft%28%5CSigma%5E%7B-1%7D-%5CSigma%5E%7B-1%7DS%5CSigma%5E%7B-1%7D%5Cright%29d%5CSigma%5Cright%29" alt="dl = \text{tr}\left(\left(\Sigma^{-1}-\Sigma^{-1}S\Sigma^{-1}\right)d\Sigma\right)">。对照导数与微分的联系，有<img src="https://www.zhihu.com/equation?tex=%5Cfrac%7B%5Cpartial+l+%7D%7B%5Cpartial+%5CSigma%7D%3D%28%5CSigma%5E%7B-1%7D-%5CSigma%5E%7B-1%7DS%5CSigma%5E%7B-1%7D%29%5ET" alt="\frac{\partial l }{\partial \Sigma}=(\Sigma^{-1}-\Sigma^{-1}S\Sigma^{-1})^T">，其零点即<img src="https://www.zhihu.com/equation?tex=%5CSigma" alt="\Sigma">的最大似然估计为<img src="https://www.zhihu.com/equation?tex=%5CSigma+%3D+S" alt="\Sigma = S">。</p>
<p>最后一例留给经典的神经网络。神经网络的求导术是学术史上的重要成果，还有个专门的名字叫做BP算法，我相信如今很多人在初次推导BP算法时也会颇费一番脑筋，事实上使用矩阵求导术来推导并不复杂。为简化起见，我们推导二层神经网络的BP算法。</p>
<p>例5【二层神经网络】：<img src="https://www.zhihu.com/equation?tex=l+%3D+-%5Cboldsymbol%7By%7D%5ET%5Clog%5Ctext%7Bsoftmax%7D%28W_2%5Csigma%28W_1%5Cboldsymbol%7Bx%7D%29%29" alt="l = -\boldsymbol{y}^T\log\text{softmax}(W_2\sigma(W_1\boldsymbol{x}))">，求<img src="https://www.zhihu.com/equation?tex=%5Cfrac%7B%5Cpartial+l%7D%7B%5Cpartial+W_1%7D" alt="\frac{\partial l}{\partial W_1}">和<img src="https://www.zhihu.com/equation?tex=%5Cfrac%7B%5Cpartial+l%7D%7B%5Cpartial+W_2%7D" alt="\frac{\partial l}{\partial W_2}">。其中<img src="https://www.zhihu.com/equation?tex=%5Cboldsymbol%7By%7D" alt="\boldsymbol{y}">是除一个元素为1外其它元素为0的的<img src="https://www.zhihu.com/equation?tex=m%C3%971" alt="m×1">列向量，<img src="https://www.zhihu.com/equation?tex=W_2" alt="W_2">是<img src="https://www.zhihu.com/equation?tex=m%5Ctimes+p" alt="m\times p">矩阵，<img src="https://www.zhihu.com/equation?tex=W_1" alt="W_1">是<img src="https://www.zhihu.com/equation?tex=p%5Ctimes+n" alt="p\times n">矩阵，<img src="https://www.zhihu.com/equation?tex=%5Cboldsymbol%7Bx%7D" alt="\boldsymbol{x}">是<img src="https://www.zhihu.com/equation?tex=n%C3%971" alt="n×1">列向量，<img src="https://www.zhihu.com/equation?tex=l" alt="l">是标量；<img src="https://www.zhihu.com/equation?tex=%5Ctext%7Bsoftmax%7D%28%5Cboldsymbol%7Ba%7D%29+%3D+%5Cfrac%7B%5Cexp%28%5Cboldsymbol%7Ba%7D%29%7D%7B%5Cboldsymbol%7B1%7D%5ET%5Cexp%28%5Cboldsymbol%7Ba%7D%29%7D" alt="\text{softmax}(\boldsymbol{a}) = \frac{\exp(\boldsymbol{a})}{\boldsymbol{1}^T\exp(\boldsymbol{a})}">同例3，<img src="https://www.zhihu.com/equation?tex=%5Csigma%28%5Ccdot%29" alt="\sigma(\cdot)">是逐元素sigmoid函数<img src="https://www.zhihu.com/equation?tex=%5Csigma%28a%29+%3D+%5Cfrac%7B1%7D%7B1%2B%5Cexp%28-a%29%7D" alt="\sigma(a) = \frac{1}{1+\exp(-a)}">。</p>
<p>解：定义<img src="https://www.zhihu.com/equation?tex=%5Cboldsymbol%7Ba%7D_1%3DW_1%5Cboldsymbol%7Bx%7D" alt="\boldsymbol{a}_1=W_1\boldsymbol{x}">，<img src="https://www.zhihu.com/equation?tex=%5Cboldsymbol%7Bh%7D_1+%3D+%5Csigma%28%5Cboldsymbol%7Ba%7D_1%29" alt="\boldsymbol{h}_1 = \sigma(\boldsymbol{a}_1)">，<img src="https://www.zhihu.com/equation?tex=%5Cboldsymbol%7Ba%7D_2+%3D+W_2+%5Cboldsymbol%7Bh%7D_1" alt="\boldsymbol{a}_2 = W_2 \boldsymbol{h}_1">，则<img src="https://www.zhihu.com/equation?tex=l+%3D-%5Cboldsymbol%7By%7D%5ET%5Clog%5Ctext%7Bsoftmax%7D%28%5Cboldsymbol%7Ba%7D_2%29" alt="l =-\boldsymbol{y}^T\log\text{softmax}(\boldsymbol{a}_2)">。在例3中已求出<img src="https://www.zhihu.com/equation?tex=%5Cfrac%7B%5Cpartial+l%7D%7B%5Cpartial+%5Cboldsymbol%7Ba%7D_2%7D+%3D+%5Ctext%7Bsoftmax%7D%28%5Cboldsymbol%7Ba%7D_2%29-%5Cboldsymbol%7By%7D+" alt="\frac{\partial l}{\partial \boldsymbol{a}_2} = \text{softmax}(\boldsymbol{a}_2)-\boldsymbol{y} ">。使用复合法则，注意此处<img src="https://www.zhihu.com/equation?tex=%5Cboldsymbol%7Bh%7D_1%2C+W_2" alt="\boldsymbol{h}_1, W_2">都是变量：<img src="https://www.zhihu.com/equation?tex=dl+%3D+%5Ctext%7Btr%7D%5Cleft%28%5Cfrac%7B%5Cpartial+l%7D%7B%5Cpartial+%5Cboldsymbol%7Ba%7D_2%7D%5ETd%5Cboldsymbol%7Ba%7D_2%5Cright%29+%3D+%5Ctext%7Btr%7D%5Cleft%28%5Cfrac%7B%5Cpartial+l%7D%7B%5Cpartial+%5Cboldsymbol%7Ba%7D_2%7D%5ETdW_2+%5Cboldsymbol%7Bh%7D_1%5Cright%29+%2B+%5Ctext%7Btr%7D%5Cleft%28%5Cfrac%7B%5Cpartial+l%7D%7B%5Cpartial+%5Cboldsymbol%7Ba%7D_2%7D%5ETW_2+d%5Cboldsymbol%7Bh%7D_1%5Cright%29" alt="dl = \text{tr}\left(\frac{\partial l}{\partial \boldsymbol{a}_2}^Td\boldsymbol{a}_2\right) = \text{tr}\left(\frac{\partial l}{\partial \boldsymbol{a}_2}^TdW_2 \boldsymbol{h}_1\right) + \text{tr}\left(\frac{\partial l}{\partial \boldsymbol{a}_2}^TW_2 d\boldsymbol{h}_1\right)">，使用矩阵乘法交换的迹技巧从第一项得到<img src="https://www.zhihu.com/equation?tex=%5Cfrac%7B%5Cpartial+l%7D%7B%5Cpartial+W_2%7D%3D+%5Cfrac%7B%5Cpartial+l%7D%7B%5Cpartial%5Cboldsymbol%7Ba%7D_2%7D%5Cboldsymbol%7Bh%7D_1%5ET" alt="\frac{\partial l}{\partial W_2}= \frac{\partial l}{\partial\boldsymbol{a}_2}\boldsymbol{h}_1^T">，从第二项得到<img src="https://www.zhihu.com/equation?tex=%5Cfrac%7B%5Cpartial+l%7D%7B%5Cpartial+%5Cboldsymbol%7Bh%7D_1%7D%3D+W_2%5ET%5Cfrac%7B%5Cpartial+l%7D%7B%5Cpartial%5Cboldsymbol%7Ba%7D_2%7D" alt="\frac{\partial l}{\partial \boldsymbol{h}_1}= W_2^T\frac{\partial l}{\partial\boldsymbol{a}_2}">。接下来求<img src="https://www.zhihu.com/equation?tex=%5Cfrac%7B%5Cpartial+l%7D%7B%5Cpartial+%5Cboldsymbol%7Ba%7D_1%7D" alt="\frac{\partial l}{\partial \boldsymbol{a}_1}">，继续使用复合法则，并利用矩阵乘法和逐元素乘法交换的迹技巧：<img src="https://www.zhihu.com/equation?tex=%5Ctext%7Btr%7D%5Cleft%28%5Cfrac%7B%5Cpartial+l%7D%7B%5Cpartial%5Cboldsymbol%7Bh%7D_1%7D%5ETd%5Cboldsymbol%7Bh%7D_1%5Cright%29+%3D+%5Ctext%7Btr%7D%5Cleft%28%5Cfrac%7B%5Cpartial+l%7D%7B%5Cpartial%5Cboldsymbol%7Bh%7D_1%7D%5ET%28%5Csigma%27%28%5Cboldsymbol%7Ba%7D_1%29%5Codot+d%5Cboldsymbol%7Ba%7D_1%29%5Cright%29+%3D+%5Ctext%7Btr%7D%5Cleft%28%5Cleft%28%5Cfrac%7B%5Cpartial+l%7D%7B%5Cpartial%5Cboldsymbol%7Bh%7D_1%7D%5Codot+%5Csigma%27%28%5Cboldsymbol%7Ba%7D_1%29%5Cright%29%5ETd%5Cboldsymbol%7Ba%7D_1%5Cright%29" alt="\text{tr}\left(\frac{\partial l}{\partial\boldsymbol{h}_1}^Td\boldsymbol{h}_1\right) = \text{tr}\left(\frac{\partial l}{\partial\boldsymbol{h}_1}^T(\sigma&#39;(\boldsymbol{a}_1)\odot d\boldsymbol{a}_1)\right) = \text{tr}\left(\left(\frac{\partial l}{\partial\boldsymbol{h}_1}\odot \sigma&#39;(\boldsymbol{a}_1)\right)^Td\boldsymbol{a}_1\right)">，得到<img src="https://www.zhihu.com/equation?tex=%5Cfrac%7B%5Cpartial+l%7D%7B%5Cpartial+%5Cboldsymbol%7Ba%7D_1%7D%3D+%5Cfrac%7B%5Cpartial+l%7D%7B%5Cpartial%5Cboldsymbol%7Bh%7D_1%7D%5Codot%5Csigma%27%28%5Cboldsymbol%7Ba%7D_1%29" alt="\frac{\partial l}{\partial \boldsymbol{a}_1}= \frac{\partial l}{\partial\boldsymbol{h}_1}\odot\sigma&#39;(\boldsymbol{a}_1)">。为求<img src="https://www.zhihu.com/equation?tex=%5Cfrac%7B%5Cpartial+l%7D%7B%5Cpartial+W_1%7D" alt="\frac{\partial l}{\partial W_1}">，再用一次复合法则：<img src="https://www.zhihu.com/equation?tex=%5Ctext%7Btr%7D%5Cleft%28%5Cfrac%7B%5Cpartial+l%7D%7B%5Cpartial%5Cboldsymbol%7Ba%7D_1%7D%5ETd%5Cboldsymbol%7Ba%7D_1%5Cright%29+%3D+%5Ctext%7Btr%7D%5Cleft%28%5Cfrac%7B%5Cpartial+l%7D%7B%5Cpartial%5Cboldsymbol%7Ba%7D_1%7D%5ETdW_1%5Cboldsymbol%7Bx%7D%5Cright%29+%3D+%5Ctext%7Btr%7D%5Cleft%28%5Cboldsymbol%7Bx%7D%5Cfrac%7B%5Cpartial+l%7D%7B%5Cpartial%5Cboldsymbol%7Ba%7D_1%7D%5ETdW_1%5Cright%29" alt="\text{tr}\left(\frac{\partial l}{\partial\boldsymbol{a}_1}^Td\boldsymbol{a}_1\right) = \text{tr}\left(\frac{\partial l}{\partial\boldsymbol{a}_1}^TdW_1\boldsymbol{x}\right) = \text{tr}\left(\boldsymbol{x}\frac{\partial l}{\partial\boldsymbol{a}_1}^TdW_1\right)">，得到<img src="https://www.zhihu.com/equation?tex=%5Cfrac%7B%5Cpartial+l%7D%7B%5Cpartial+W_1%7D%3D+%5Cfrac%7B%5Cpartial+l%7D%7B%5Cpartial%5Cboldsymbol%7Ba%7D_1%7D%5Cboldsymbol%7Bx%7D%5ET" alt="\frac{\partial l}{\partial W_1}= \frac{\partial l}{\partial\boldsymbol{a}_1}\boldsymbol{x}^T">。</p>

      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2018/07/09/通过expect脚本实现iTerm2自动登录/" rel="next" title="通过expect实现iTerm2自动登录">
                <i class="fa fa-chevron-left"></i> 通过expect实现iTerm2自动登录
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2018/07/29/矩阵求导术1/" rel="prev" title="">
                 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">John Doe</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">6</span>
                  <span class="site-state-item-name">posts</span>
                </a>
              </div>
            

            

            

          </nav>

          

          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">John Doe</span>

  
</div>


  <div class="powered-by">Powered by <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a></div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Pisces</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
